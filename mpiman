#!/usr/bin/env python3
# Python script for get man mages for any MPI binding.
#
# Originally mostly intended for MPI C++ bindings, but also useful for
# the closely related python bindings in mpi4py, whose names can vary
# quite a bit from their C and Fortran counterparts, and also nice to
# get man pages when you don't remember or know the exact MPI routine
# name.
#
# To be ported soon to python 3
#
# Usage example: 
#    $ mpiman AllGather
#
# Notes:
#   - Search is case-insensitive.
#   - Following prefixes may be omitted:
#     "MPI::", "MPI::COMM::", "MPI::CARTCOMM::", 
#     "MPI::INTRACOMM::", "MPI::REQUEST::", 
#     "MPI::GROUP::", "MPI::STATUS", "MPI::GRAPHCOMM"
#     (this is too much, and leads to ambiguities: need a fix!)
#   - Since fortran bindings have the same name as the C ones but
#     all capitalized, so mostly they get picked up automatically.
#
# Ramses van  Zon, SciNet, UoT, 2010-2023

import os,sys

#Map missing cxx man page keys to real man page keys
#   The keys have been capitalized to do case insensitive queries. 
#   Contains fake keys 'deprecatedXX' for deprecated MPI1 fortran and c
#   bindings with no c++ equivalent. Because these keys are not
#   capitalized, they will not be found even when typing "mpiman
#   deprecated01". A bit of a hack, admittedly.
mpi_bindings = {'MPI::COMM::ABORT'                    : 'MPI_Abort',
                'MPI::WIN::ACCUMULATE'                : 'MPI_Accumulate',
                'MPI::ADD_ERROR_CLASS'                : 'MPI_Add_error_class',
                'MPI::ADD_ERROR_CODE'                 : 'MPI_Add_error_code',
                'MPI::ADD_ERROR_STRING'               : 'MPI_Add_error_string',
                'MPI::COMM::ALLGATHER'                : 'MPI_Allgather',
                'MPI::COMM::ALLGATHERV'               : 'MPI_Allgatherv',
                'MPI::ALLOC_MEM'                      : 'MPI_Alloc_mem',
                'MPI::COMM::ALLREDUCE'                : 'MPI_Allreduce',
                'MPI::COMM::ALLTOALL'                 : 'MPI_Alltoall',
                'MPI::COMM::ALLTOALLV'                : 'MPI_Alltoallv',
                'MPI::COMM::ALLTOALLW'                : 'MPI_Alltoallw',
                'MPI::COMM::BARRIER'                  : 'MPI_Barrier',
                'MPI::COMM::BCAST'                    : 'MPI_Bcast',
                'MPI::COMM::BSEND'                    : 'MPI_Bsend',
                'MPI::COMM::BSEND_INIT'               : 'MPI_Bsend_init',
                'MPI::ATTACH_BUFFER'                  : 'MPI_Buffer_attach',
                'MPI::DETACH_BUFFER'                  : 'MPI_Buffer_detach',
                'MPI::REQUEST::CANCEL'                : 'MPI_Cancel',
                'MPI::CARTCOMM::GET_COORDS'           : 'MPI_Cart_coords',
                'MPI::INTRACOMM.CREATE_CART'          : 'MPI_Cart_create',
                'MPI::CARTCOMM::GET_DIM'              : 'MPI_Cartdim_get',
                'MPI::CARTCOMM::GET_TOPO'             : 'MPI_Cart_get',
                'MPI::CARTCOMM::MAP'                  : 'MPI_Cart_map',
                'MPI::CARTCOMM::GET_CART_RANK'        : 'MPI_Cart_rank',
                'MPI::CARTCOMM::SHIFT'                : 'MPI_Cart_shift',
                'MPI::CARTCOMM::SUB'                  : 'MPI_Cart_sub',
                'MPI::CLOSE_PORT'                     : 'MPI_Close_port',
                'MPI::INTRACOMM::ACCEPT'              : 'MPI_Comm_accept',
                'MPI::COMM::CALL_ERRHANDLER'          : 'MPI_Comm_call_errhandler',
                'MPI::COMM::COMPARE'                  : 'MPI_Comm_compare',
                'MPI::INTRACOMM::CONNECT'             : 'MPI_Comm_connect',
                'MPI::INTERCOMM::CREATE'              : 'MPI_Comm_create',
                'MPI::COMM::CREATE_ERRHANDLER'        : 'MPI_Comm_create_errhandler',
                'MPI::COMM::CREATE_KEYVAL'            : 'MPI_Comm_create_keyval',
                'MPI::COMM::DELETE_ATTR'              : 'MPI_Comm_delete_attr',
                'MPI::COMM::DISCONNECT'               : 'MPI_Comm_disconnect',
                'MPI::INTRACOMM::DUP'                 : 'MPI_Comm_dup',
                'MPI::COMM::FREE'                     : 'MPI_Comm_free',
                'MPI::COMM::FREE_KEYVAL'              : 'MPI_Comm_free_keyval',
                'MPI::COMM::GET_ATTR'                 : 'MPI_Comm_get_attr',
                'MPI::COMM::GET_ERRHANDLER'           : 'MPI_Comm_get_errhandler',
                'MPI::COMM::GET_NAME'                 : 'MPI_Comm_get_name',
                'MPI::COMM::GET_PARENT'               : 'MPI_Comm_get_parent',
                'MPI::COMM::GET_GROUP'                : 'MPI_Comm_group',
                'MPI::COMM::JOIN'                     : 'MPI_Comm_join',
                'MPI::COMM::GET_RANK'                 : 'MPI_Comm_rank',
                'MPI::INTERCOMM::GET_REMOTE_GROUP'    : 'MPI_Comm_remote_group',
                'MPI::INTERCOMM::GET_REMOTE_SIZE'     : 'MPI_Comm_remote_size',
                'MPI::COMM::SET_ATTR'                 : 'MPI_Comm_set_attr',
                'MPI::COMM::SET_ERRHANDLER'           : 'MPI_Comm_set_errhandler',
                'MPI::COMM::SET_NAME'                 : 'MPI_Comm_set_name',
                'MPI::COMM::GET_SIZE'                 : 'MPI_Comm_size',
                'MPI::INTRACOMM::SPAWN'               : 'MPI_Comm_spawn',
                'MPI::INTRACOMM::SPAWN_MULTIPLE'      : 'MPI_Comm_spawn_multiple',
                'MPI::INTERCOMM::SPLIT'               : 'MPI_Comm_split',
                'MPI::COMM::IS_INTER'                 : 'MPI_Comm_test_inter',
                'MPI::COMPUTE_DIMS'                   : 'MPI_Dims_create',
                'MPI::ERRHANDLER::FREE'               : 'MPI_Errhandler_free',
                'MPI::GET_ERROR_CLASS'                : 'MPI_Error_class',
                'MPI::GET_ERROR_STRING'               : 'MPI_Error_string',
                'MPI::INTRACOMM::EXSCAN'              : 'MPI_Exscan',
                'MPI::FILE::CALL_ERRHANDLER'          : 'MPI_File_call_errhandler',
                'MPI::FILE::CLOSE'                    : 'MPI_File_close',
                'MPI::FILE::CREATE_ERRHANDLER'        : 'MPI_File_create_errhandler',
                'MPI::FILE::DELETE'                   : 'MPI_File_delete',
                'MPI::FILE::GET_AMODE'                : 'MPI_File_get_amode',
                'MPI::FILE::GET_ATOMICITY'            : 'MPI_File_get_atomicity',
                'MPI::FILE::GET_BYTE_OFFSET'          : 'MPI_File_get_byte_offset',
                'MPI::FILE::GET_ERRHANDLER'           : 'MPI_File_get_errhandler',
                'MPI::FILE::GET_GROUP'                : 'MPI_File_get_group',
                'MPI::FILE::GET_INFO'                 : 'MPI_File_get_info',
                'MPI::FILE::GET_POSITION'             : 'MPI_File_get_position',
                'MPI::FILE::GET_POSITION_SHARED'      : 'MPI_File_get_position_shared',
                'MPI::FILE::GET_SIZE'                 : 'MPI_File_get_size',
                'MPI::FILE::GET_TYPE_EXTENT'          : 'MPI_File_get_type_extent',
                'MPI::FILE::GET_VIEW'                 : 'MPI_File_get_view',
                'MPI::FILE::IREAD'                    : 'MPI_File_iread',
                'MPI::FILE::IREAD_AT'                 : 'MPI_File_iread_at',
                'MPI::FILE::IREAD_SHARED'             : 'MPI_File_iread_shared',
                'MPI::FILE::IWRITE'                   : 'MPI_File_iwrite',
                'MPI::FILE::IWRITE_AT'                : 'MPI_File_iwrite_at',
                'MPI::FILE::IWRITE_SHARED'            : 'MPI_File_iwrite_shared',
                'MPI::FILE::OPEN'                     : 'MPI_File_open',
                'MPI::FILE::PREALLOCATE'              : 'MPI_File_preallocate',
                'MPI::FILE::READ'                     : 'MPI_File_read',
                'MPI::FILE::READ_ALL'                 : 'MPI_File_read_all',
                'MPI::FILE::READ_ALL_BEGIN'           : 'MPI_File_read_all_begin',
                'MPI::FILE::READ_ALL_END'             : 'MPI_File_read_all_end',
                'MPI::FILE::READ_AT'                  : 'MPI_File_read_at',
                'MPI::FILE::READ_AT_ALL'              : 'MPI_File_read_at_all',
                'MPI::FILE::READ_AT_ALL_BEGIN'        : 'MPI_File_read_at_all_begin',
                'MPI::FILE::READ_AT_ALL_END'          : 'MPI_File_read_at_all_end',
                'MPI::FILE::READ_ORDERED'             : 'MPI_File_read_ordered',
                'MPI::FILE::READ_ORDERED_BEGIN'       : 'MPI_File_read_ordered_begin',
                'MPI::FILE::READ_ORDERED_END'         : 'MPI_File_read_ordered_end',
                'MPI::FILE::READ_SHARED'              : 'MPI_File_read_shared',
                'MPI::FILE::SEEK'                     : 'MPI_File_seek',
                'MPI::FILE::SEEK_SHARED'              : 'MPI_File_seek_shared',
                'MPI::FILE::SET_ATOMICITY'            : 'MPI_File_set_atomicity',
                'MPI::FILE::SET_ERRHANDLER'           : 'MPI_File_set_errhandler',
                'MPI::FILE::SET_INFO'                 : 'MPI_File_set_info',
                'MPI::FILE::SET_SIZE'                 : 'MPI_File_set_size',
                'MPI::FILE::SET_VIEW'                 : 'MPI_File_set_view',
                'MPI::FILE::SYNC'                     : 'MPI_File_sync',
                'MPI::FILE::WRITE'                    : 'MPI_File_write',
                'MPI::FILE::WRITE_ALL'                : 'MPI_File_write_all',
                'MPI::FILE::WRITE_ALL_BEGIN'          : 'MPI_File_write_all_begin',
                'MPI::FILE::WRITE_ALL_END'            : 'MPI_File_write_all_end',
                'MPI::FILE::WRITE_AT'                 : 'MPI_File_write_at',
                'MPI::FILE::WRITE_AT_ALL'             : 'MPI_File_write_at_all',
                'MPI::FILE::WRITE_AT_ALL_BEGIN'       : 'MPI_File_write_at_all_begin',
                'MPI::FILE::WRITE_AT_ALL_END'         : 'MPI_File_write_at_all_end',
                'MPI::FILE::WRITE_ORDERED'            : 'MPI_File_write_ordered',
                'MPI::FILE::WRITE_ORDERED_BEGIN'      : 'MPI_File_write_ordered_begin',
                'MPI::FILE::WRITE_ORDERED_END'        : 'MPI_File_write_ordered_end',
                'MPI::FILE::WRITE_SHARED'             : 'MPI_File_write_shared',
                'MPI::FINALIZE'                       : 'MPI_Finalize',
                'MPI::IS_FINALIZED'                   : 'MPI_Finalized',
                'MPI::FREE_MEM'                       : 'MPI_Free_mem',
                'MPI::COMM::GATHER'                   : 'MPI_Gather',
                'MPI::COMM::GATHERV'                  : 'MPI_Gatherv',
                'MPI::WIN::GET'                       : 'MPI_Get',
                'MPI::GET_ADDRESS'                    : 'MPI_Get_address',
                'MPI::STATUS::GET_COUNT'              : 'MPI_Get_count',
                'MPI::STATUS::GET_ELEMENTS'           : 'MPI_Get_elements',
                'MPI::STATUS::GET_ELEMENTS'           : 'MPI_Get_elements_x',
                'MPI::GET_PROCESSOR_NAME'             : 'MPI_Get_processor_name',
                'MPI::GET_VERSION'                    : 'MPI_Get_version',
                'MPI::INTRACOMM::CREATE_GRAPH'        : 'MPI_Graph_create',
                'MPI::GRAPHCOMM::GET'                 : 'MPI_Graphdims_get',
                'MPI::GRAPHCOMM::GET_TOPO'            : 'MPI_Graph_get',
                'MPI::GRAPHCOMM::MAP'                 : 'MPI_Graph_map',
                'MPI::GRAPHCOMM::GET_NEIGHBORS'       : 'MPI_Graph_neighbors',
                'MPI::GRAPHCOMM::GET_NEIGHBORS_COUNT' : 'MPI_Graph_neighbors_count',
                'MPI::GREQUEST::COMPLETE'             : 'MPI_Grequest_complete',
                'MPI::GREQUEST::START'                : 'MPI_Grequest_start',
                'MPI::GROUP::COMPARE'                 : 'MPI_Group_compare',
                'MPI::GROUP::DIFFERENCE'              : 'MPI_Group_difference',
                'MPI::GROUP::EXCL'                    : 'MPI_Group_excl',
                'MPI::GROUP::FREE'                    : 'MPI_Group_free',
                'MPI::GROUP::INCL'                    : 'MPI_Group_incl',
                'MPI::GROUP::INTERSECT'               : 'MPI_Group_intersection',
                'MPI::GROUP::RANGE_EXCL'              : 'MPI_Group_range_excl',
                'MPI::GROUP::RANGE_INCL'              : 'MPI_Group_range_incl',
                'MPI::GROUP::GET_RANK'                : 'MPI_Group_rank',
                'MPI::GROUP::GET_SIZE'                : 'MPI_Group_size',
                'MPI::GROUP::TRANSLATE_RANKS'         : 'MPI_Group_translate_ranks',
                'MPI::GROUP::UNION'                   : 'MPI_Group_union',
                'MPI::COMM::ALLGATHER'                : 'MPI_Iallgather',
                'MPI::COMM::ALLGATHERV'               : 'MPI_Iallgatherv',
                'MPI::COMM::ALLREDUCE'                : 'MPI_Iallreduce',
                'MPI::COMM::ALLTOALL'                 : 'MPI_Ialltoall',
                'MPI::COMM::ALLTOALLV'                : 'MPI_Ialltoallv',
                'MPI::COMM::ALLTOALLW'                : 'MPI_Ialltoallw',
                'MPI::COMM::BARRIER'                  : 'MPI_Ibarrier',
                'MPI::COMM::BCAST'                    : 'MPI_Ibcast',
                'MPI::COMM::IBSEND'                   : 'MPI_Ibsend',
                'MPI::INTRACOMM::EXSCAN'              : 'MPI_Iexscan',
                'MPI::COMM::GATHER'                   : 'MPI_Igather',
                'MPI::COMM::GATHERV'                  : 'MPI_Igatherv',
                'MPI::INFO::CREATE'                   : 'MPI_Info_create',
                'MPI::INFO::DELETE'                   : 'MPI_Info_delete',
                'MPI::INFO::DUP'                      : 'MPI_Info_dup',
                'MPI::INFO::FREE'                     : 'MPI_Info_free',
                'MPI::INFO::GET'                      : 'MPI_Info_get',
                'MPI::INFO::GET_NKEYS'                : 'MPI_Info_get_nkeys',
                'MPI::INFO::GET_NTHKEY'               : 'MPI_Info_get_nthkey',
                'MPI::INFO::GET_VALUELEN'             : 'MPI_Info_get_valuelen',
                'MPI::INFO::SET'                      : 'MPI_Info_set',
                'MPI::INIT'                           : 'MPI_Init',
                'MPI::IS_INITIALIZED'                 : 'MPI_Initialized',
                'MPI::INIT_THREAD'                    : 'MPI_Init_thread',
                'MPI::INTRACOMM::CREATE_INTERCOMM'    : 'MPI_Intercomm_create',
                'MPI::INTERCOMM::MERGE'               : 'MPI_Intercomm_merge',
                'MPI::COMM::IPROBE'                   : 'MPI_Iprobe',
                'MPI::COMM::IRECV'                    : 'MPI_Irecv',
                'MPI::INTRACOMM::REDUCE'              : 'MPI_Ireduce',
                'MPI::COMM::REDUCE_SCATTER'           : 'MPI_Ireduce_scatter',
                'MPI::COMM::IRSEND'                   : 'MPI_Irsend',
                'MPI::INTRACOMM::SCAN'                : 'MPI_Iscan',
                'MPI::COMM::SCATTER'                  : 'MPI_Iscatter',
                'MPI::COMM::SCATTERV'                 : 'MPI_Iscatterv',
                'MPI::COMM::ISEND'                    : 'MPI_Isend',
                'MPI::COMM::ISSEND'                   : 'MPI_Issend',
                'MPI::IS_THREAD_MAIN'                 : 'MPI_Is_thread_main',
                'MPI::LOOKUP_NAME'                    : 'MPI_Lookup_name',
                'MPI::OP::IS_COMMUTATIVE'             : 'MPI_Op_commutative',
                'MPI::OP::INIT'                       : 'MPI_Op_create',
                'MPI::OPEN_PORT'                      : 'MPI_Open_port',
                'MPI::OP::FREE'                       : 'MPI_Op_free',
                'MPI::DATATYPE::PACK'                 : 'MPI_Pack',
                'MPI::DATATYPE::PACK_EXTERNAL'        : 'MPI_Pack_external',
                'MPI::DATATYPE::PACK_EXTERNAL_SIZE'   : 'MPI_Pack_external_size',
                'MPI::DATATYPE::PACK_SIZE'            : 'MPI_Pack_size',
                'MPI::PCONTROL'                       : 'MPI_Pcontrol',
                'MPI::COMM::PROBE'                    : 'MPI_Probe',
                'MPI::PUBLISH_NAME'                   : 'MPI_Publish_name',
                'MPI::WIN::PUT'                       : 'MPI_Put',
                'MPI::QUERY_THREAD'                   : 'MPI_Query_thread',
                'MPI::WIN::ACCUMULATE'                : 'MPI_Raccumulate',
                'MPI::COMM::RECV'                     : 'MPI_Recv',
                'MPI::COMM::RECV_INIT'                : 'MPI_Recv_init',
                'MPI::INTRACOMM::REDUCE'              : 'MPI_Reduce',
                'MPI::OP::REDUCE_LOCAL'               : 'MPI_Reduce_local',
                'MPI::COMM::REDUCE_SCATTER'           : 'MPI_Reduce_scatter',
                'MPI::REGISTER_DATAREP'               : 'MPI_Register_datarep',
                'MPI::REQUEST::FREE'                  : 'MPI_Request_free',
                'MPI::REQUEST::GET_STATUS'            : 'MPI_Request_get_status',
                'MPI::WIN::GET'                       : 'MPI_Rget',
                'MPI::WIN::PUT'                       : 'MPI_Rput',
                'MPI::COMM::RSEND'                    : 'MPI_Rsend',
                'MPI::COMM::RSEND_INIT'               : 'MPI_Rsend_init',
                'MPI::INTRACOMM::SCAN'                : 'MPI_Scan',
                'MPI::COMM::SCATTER'                  : 'MPI_Scatter',
                'MPI::COMM::SCATTERV'                 : 'MPI_Scatterv',
                'MPI::COMM::SEND'                     : 'MPI_Send',
                'MPI::COMM::SEND_INIT'                : 'MPI_Send_init',
                'MPI::COMM::SENDRECV'                 : 'MPI_Sendrecv',
                'MPI::COMM::SENDRECV_REPLACE'         : 'MPI_Sendrecv_replace',
                'MPI::COMM::SSEND'                    : 'MPI_Ssend',
                'MPI::COMM::SSEND_INIT'               : 'MPI_Ssend_init',
                'MPI::PREQUEST::START'                : 'MPI_Start',
                'MPI::PREQUEST::STARTALL'             : 'MPI_Startall',
                'MPI::STATUS::SET_CANCELLED'          : 'MPI_Status_set_cancelled',
                'MPI::STATUS::SET_ELEMENTS'           : 'MPI_Status_set_elements',
                'MPI::STATUS::SET_ELEMENTS'           : 'MPI_Status_set_elements_x',
                'MPI::REQUEST::TEST'                  : 'MPI_Test',
                'MPI::REQUEST::TESTALL'               : 'MPI_Testall',
                'MPI::REQUEST::TESTANY'               : 'MPI_Testany',
                'MPI::STATUS::IS_CANCELLED'           : 'MPI_Test_cancelled',
                'MPI::REQUEST::TESTSOME'              : 'MPI_Testsome',
                'MPI::COMM::GET_TOPOLOGY'             : 'MPI_Topo_test',
                'MPI::DATATYPE::COMMIT'               : 'MPI_Type_commit',
                'MPI::DATATYPE::CREATE_CONTIGUOUS'    : 'MPI_Type_contiguous',
                'MPI::DATATYPE::CREATE_DARRAY'        : 'MPI_Type_create_darray',
                'MPI::DATATYPE::CREATE_F90_COMPLEX'   : 'MPI_Type_create_f90_complex',
                'MPI::DATATYPE::CREATE_F90_INTEGER'   : 'MPI_Type_create_f90_integer',
                'MPI::DATATYPE::CREATE_F90_REAL'      : 'MPI_Type_create_f90_real',
                'MPI::DATATYPE::CREATE_INDEXED'       : 'MPI_Type_create_hindexed',
                'MPI::DATATYPE::CREATE_INDEXED_BLOCK' : 'MPI_Type_create_hindexed_block',
                'MPI::DATATYPE::CREATE_HVECTOR'       : 'MPI_Type_create_hvector',
                'MPI::DATATYPE::CREATE_INDEXED_BLOCK' : 'MPI_Type_create_indexed_block',
                'MPI::DATATYPE::CREATE_KEYVAL'        : 'MPI_Type_create_keyval',
                'MPI::DATATYPE::CREATE_RESIZED'       : 'MPI_Type_create_resized',
                'MPI::DATATYPE::CREATE_STRUCT'        : 'MPI_Type_create_struct',
                'MPI::DATATYPE::CREATE_SUBARRAY'      : 'MPI_Type_create_subarray',
                'MPI::DATATYPE::DELETE_ATTR'          : 'MPI_Type_delete_attr',
                'MPI::DATATYPE::DUP'                  : 'MPI_Type_dup',
                'MPI::DATATYPE::FREE'                 : 'MPI_Type_free',
                'MPI::DATATYPE::FREE_KEYVAL'          : 'MPI_Type_free_keyval',
                'MPI::DATATYPE::GET_ATTR'             : 'MPI_Type_get_attr',
                'MPI::DATATYPE::GET_CONTENTS'         : 'MPI_Type_get_contents',
                'MPI::DATATYPE::GET_ENVELOPE'         : 'MPI_Type_get_envelope',
                'MPI::DATATYPE::GET_EXTENT'           : 'MPI_Type_get_extent',
                'MPI::DATATYPE::GET_EXTENT'           : 'MPI_Type_get_extent_x',
                'MPI::DATATYPE::GET_NAME'             : 'MPI_Type_get_name',
                'MPI::DATATYPE::GET_TRUE_EXTENT'      : 'MPI_Type_get_true_extent',
                'MPI::DATATYPE::GET_TRUE_EXTENT'      : 'MPI_Type_get_true_extent_x',
                'MPI::DATATYPE::CREATE_INDEXED'       : 'MPI_Type_indexed',
                'MPI::MATCH_SIZE'                     : 'MPI_Type_match_size',
                'MPI::DATATYPE::SET_ATTR'             : 'MPI_Type_set_attr',
                'MPI::DATATYPE::SET_NAME'             : 'MPI_Type_set_name',
                'MPI::DATATYPE::GET_SIZE'             : 'MPI_Type_size',
                'MPI::DATATYPE::GET_SIZE'             : 'MPI_Type_size_x',
                'MPI::DATATYPE::CREATE_VECTOR'        : 'MPI_Type_vector',
                'MPI::DATATYPE::UNPACK'               : 'MPI_Unpack',
                'MPI::DATATYPE::UNPACK_EXTERNAL'      : 'MPI_Unpack_external',
                'MPI::UNPUBLISH_NAME'                 : 'MPI_Unpublish_name',
                'MPI::REQUEST::WAIT'                  : 'MPI_Wait',
                'MPI::REQUEST::WAITALL'               : 'MPI_Waitall',
                'MPI::REQUEST::WAITANY'               : 'MPI_Waitany',
                'MPI::REQUEST::WAITSOME'              : 'MPI_Waitsome',
                'MPI::WIN::CALL_ERRHANDLER'           : 'MPI_Win_call_errhandler',
                'MPI::WIN::COMPLETE'                  : 'MPI_Win_complete',
                'MPI::WIN::CREATE'                    : 'MPI_Win_create',
                'MPI::WIN::CREATE_ERRHANDLER'         : 'MPI_Win_create_errhandler',
                'MPI::WIN::CREATE_KEYVAL'             : 'MPI_Win_create_keyval',
                'MPI::WIN::DELETE_ATTR'               : 'MPI_Win_delete_attr',
                'MPI::WIN::FENCE'                     : 'MPI_Win_fence',
                'MPI::WIN::FREE'                      : 'MPI_Win_free',
                'MPI::WIN::FREE_KEYVAL'               : 'MPI_Win_free_keyval',
                'MPI::WIN::GET_ATTR'                  : 'MPI_Win_get_attr',
                'MPI::WIN::GET_ERRHANDLER'            : 'MPI_Win_get_errhandler',
                'MPI::WIN::GET_GROUP'                 : 'MPI_Win_get_group',
                'MPI::WIN::GET_NAME'                  : 'MPI_Win_get_name',
                'MPI::WIN::LOCK'                      : 'MPI_Win_lock',
                'MPI::WIN::POST'                      : 'MPI_Win_post',
                'MPI::WIN::SET_ATTR'                  : 'MPI_Win_set_attr',
                'MPI::WIN::SET_ERRHANDLER'            : 'MPI_Win_set_errhandler',
                'MPI::WIN::SET_NAME'                  : 'MPI_Win_set_name',
                'MPI::WIN::START'                     : 'MPI_Win_start',
                'MPI::WIN::TEST'                      : 'MPI_Win_test',
                'MPI::WIN::UNLOCK'                    : 'MPI_Win_unlock',
                'MPI::WIN::WAIT'                      : 'MPI_Win_wait',
                'MPI::WTICK'                          : 'MPI_Wtick',
                'MPI::WTIME'                          : 'MPI_Wtime',
                }

#Function to try and match a key to a man page for one argument
def find(arg):
    upcasearg=arg.upper()
    # Prefixes that may be omitted (leads to undetected ambiguities: need to return a list, but not yet implemented)
    prefixes = "", "MPI::", "MPI::COMM::", "MPI::CARTCOMM::", "MPI::INTERCOMM::", "MPI::INTRACOMM::", "MPI::REQUEST::", "MPI::GROUP::", "MPI::STATUS", "MPI::GRAPHCOMM", "MPI::FILE::"
    # Check the keys first
    for prefix in prefixes:
        try:
            return mpi_bindings[prefix+upcasearg]
        except KeyError: pass #if not found, keep looking with other prefix
    prefixes = "", "MPI_", "MPI_ATTR_", "MPI_CART_", "MPI_GROUP_", "MPI_REQUEST_"
    #  Check the values if nothing was found 
    for prefix in prefixes:
        for lang in mpi_bindings.values(): 
            if prefix+upcasearg == lang.upper():
                return lang
    return ""
 
#Function to try and find a man page for one argument
def mpiman(key):
    realkey = find(key)
    if realkey == "":
        print(key + " not in mpi manpage list.")
    else:
        os.system("man " + realkey)
 
#Program starts here: Loops over all arguments (except the first, which is mpiman itself)
if (len(sys.argv) == 1):
    print("a list of c++ bindings:")
    for all in sorted(mpi_bindings.keys()):
        if all.startswith("MPI::"):
            print(all)
else:
    for arg in sys.argv[1:]:
        mpiman(arg)

#end of python program
